# V-242415 Secrets in Kubernets must not be stored as environment variables.
## Discussion
Secrets, such as passwords, keys, tokens, and certificates should not be stored as environment variables. These environment variables are accessible inside Kubernetes by the ```Get Pod``` API call, and by any system, such as ```CI/CD pipeline```, which has access to the definition file of the container. Secrets must be mounted from files or stored within password vaults.
## Check Text
On the kubernetes master node, run the following command: ```kubectl get all -o jsonpath='{range.items[?(@..secretKeyRef)]} {.kind} {.metadata.name} {"\n"}{end}' -A'''
If any of the values returned reference environment variables, this is a finding
## Fix Text
- [x] Any secrets stored as environment variables must be moved to the secret files with the proper protections and enforcements or placed within a password vault, for example ```hcp-vault```
